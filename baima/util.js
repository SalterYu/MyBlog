const crypto = require('crypto');
const pako = require('pako')

const token = 'dbaffa61f552c7cbf1820012f896c090'
const encrypted = 'b2c584b06801b382eb003726f8e2be070b8289e54e2419cb0c9dd718d085ec4c836436ee1095e3ebf6995964f7c8a442251c3efe355d762fcfd56a99ed4c9b1f7c38359f177cc0b9499a6cf350a0eba263418a92e0adcfba83b1db462edba9a917c6c4d24e99bb34f2e0a0a9414fd60a3630f20981243b6573611bf6080b5add6b5e9a6342defc6d963e1322f6d21836a1e7886d3aabf02d730fe346b5958dbe504df00c6be3e311dd72022e316d4f0467094ae5e02707cfeec3aa3a5a1c55e3fb98db72625e2063267afaec3b627a074b7591a8272047b07bec653c0e3ccdce9527776553409ab213bce31c94603fe729bf5ea870fc7a035a039314f5d7d77b689c6b2d7a3bac3058eb975942813a3039c1e49cc54c720b21e829af53b7c7c648469431fb8ade9aea17caf98dd67383ee1d4064b10689eed350d84f9462dcd5f0d45674b5ef5a45bd3d3b25a41b2daea74977aa3a6dc83c9fad203cb717fdb9cb200eb2e707adb7c940abe76a6f2d0bd09a7e8ed25e0cd7a170e5dae7a89a9fadc4e99b7ca3df73a01745948f64191f3ea992073cfec069843132b302fe121a9f55e9af0272ef5683be666280442b240a208318833c3dd868400daa03bf7b44f079ea678023f5ef71c60b34e4457d05e8c655545c60336d87db4651180fc086494542c25743d02b5229b503e892b6df54fadac1b186e88098accaaab70d763a4ad0498643cc98853714bdc1e13c33fbffe931fb0721707cb33cffee9cc754d8354bb1a1d1182ceabecc2df14e3cd378cd4f0c1217e0cb7cda7402a603622b6ea1da8bae15b123d1ab0103d3fea268e380476343d3e8bf0a8b4e583c73afb940273818d28f77421bb030aac3dc54fa7ea336d0f0dc93327080ab89ca84b4bd5ba9f3eb840daee986526439f672cbc1d626a13050164e58a9231b8828094d3b4d27ed68202fa70a6704d5365c0c1feb0b5d0fc7be7d21cf375f6c634c345871c82eb711635ffd6d6801d63abe6a25ea9e9fe60108ccf04c43f9535db778f65f7d4d919ba9af03f3eb28005af889316701a3c8500201a559bc662b35e8d33f58362de4cbbbdc3d2673eba1c7955262db1f55acba6944eb97143d0709f97ff0daeab8fd29fd7e88eb0837634e8a684e63692a0425878ea2d4fc26192c73bc008b83d9048b5bca30f1f8ba4ffe1b98e453e9cfd92c2a7b4944215452c002af548f8e338823986a42b2a7b730180d880476c31d37507059a2dfb45738c41b500f94fe69576dd8b3301b03662cfc93dedb26f4e9dd17a6c3db24bd0ae24d67eebf1cb2ff0c16aee53bdb910dba33b4fdcc79fc7f2ade6860020231efecd9c0a19196c986c7772a9bc28810be0ced9a7cf66f2aceee8a4b9f33dc77c75e48ea2c5f81520cca5a34fd0b37c4fab073cb8d2bff5ebd8b95fcaf8035a3e44eef7d54b9742ee33e68d8a397b4b94bf777fea35ca65586603d037e431661e34a4607f98ce0bf5eb6473747dafc9120c79c86d3998b55c335dab3069d95820fc50139e0c495c0c87b0f538b7a0130949787bf7c725f16a54fb002e486a66c79ec2f3798ddfaebe89174bae789a7b33fe2a1aec94772f9bbcc8b987dbe6e3459c8bff0b69f6a59411e5c09c2659370c62833297fd9bd24c8c69c3b5544159e599f8e02a8d8da1dfe711b31b0dba986aa5e3af173a728c91a6e6b175682117472cf15568844755bd49ee77f1ff1bf1091a8d711fa578668b23cb79c836f39a52c98530024f9e9900d4cb1d05d59e857f05d6dd3694bf59ff93430e194500ab4f52dcaca162d9bef468cf4c597d64da259b1d42d51ca127cade2e957b3c87b4b9c6a325a278017e948fae9bf0c933244d073a0e4c38fe323932515c2b4215fb45e4c33b42a9ab6dc46eaea4221b369dc1d5d24a64d1fa81b7148678d95b173ef9f7cd9a3edce5280c0656fd90e31324519c7ef12f7a2c3177d32306c8aea896f7c1f04dd7fc4896a4772d19b98a812e4f2f07a39ad91e10479b3f74c78709dba010cde6c19d06b5d0496bff10f4606e90850d83bfb66ce76bc8c35c26770a737618c4d1f8986d566476a3df8bb1ab777ad0b452ce5f6182bd1452dce48d23911330414d8a4531e4aed1d7792c1754bd5753526053fba5cdda00a7d65621ff9634c38d3db46304533ed6f834d88a3ac1ea88872a1e3e42d90367f62134e0e4e10d42eec14a2bce132c7ba2fa25bb6ce7313bfa56ea23acfc7355fb35ff59400d4028a0e1245ab33e1c242433208358e7789d2213be42a0d7b2e96a5ba5aad6471f3cb443996a2d5524f2a5578c623f9bd03a5ec2ccea942ecda0a078eec7fe3e2830875bddf0aeeab187a762ca7a24c3d629091111115967c8dfe5322c1a1c23d7ac5303369a10190bef4e073e41be67bde606dfd6f72387158bff5f7275d00e756b4ef887f87d74807a6fbc5563d77ebb378a4f78466f13d6c5363a5bb97be2a6c49d821e5ffc9f1d8985abbf763917d97f21acdcf6cf99e22727f6a2dc57eba7614c074d1cde7c04a8de03f0c04a679aee29acd7649d565f6e3ce08521d08182778ff329ac4387b4d65a176336a12beee70437b27084a25dfeaf68d58d9870737a2466058d98e5cb2032f7736a6507cb79d61b8fb6640c66f08d582b22c599b5a4c782d70535677cbbf5560477362393c9a3292a0f8650ddda0aa7936a19c6abdd114de0a75d610e9fff5f1288bfac8fa552845f1fef05efd96287bea509a6df66c9e611d03cc2f69e2e6ee3237bb88800a7cf62400e446efe89e5b3e06afdbcc65f45528ae423f895f256efb29ee21e9ae02826e64eecef80cc100e11e60bb6c21b0f1be181728fac599af0f91e6145d3d23a47b32eecf92159f2ae3e15c961e60615281df71c66fecf3864177f83d5fb255e54b9abc8c449669e7201bf23f796cea64eca4047e4ff6bca658be8c43872f0d99ad96b62129b9fb4830b7c6d4619c7f46034f1df267a6ac75cbd6a59909f2c31583f5931fb639dc5c1f8fd4638399757d144f1058475b6970e0e9675c266a99f2e3f67d9bec600f303539a9e6d56a7fade98b0efab6c230f526c4dc94e298bcfe49d2a15637d81e778343e7e0bca0bd894fe04f97ffec53134a8045d226e43a01268a8a8bca616d6a179e43dc010de6fa0f1974fa326afda000e91e5e9b61eaf26d0d0868cfb98c246236c13f114d9e5919e5a74fa9fd1f3b236c36c3aa86acce86d43b5b18ac6f714071c553e507e23802264b10fbb46ca70c3fe9d4268cee3f89d5114379ee8451d7746487e0719dae989e767a806f6fc3df19419e2e4341dc3216d6d5218b1450ea720df95c495c73324570cce923d1e385881eb78e530667579a438f2fa7446d28116daefacc82dc24c3712e524cd3c05182ca344068350ea74136191f92307c699648322ce9bd57843d447ff3cec538fc088dbd3d7f6f79cbd7b9d9296db7bf20f70a6e63711c9b9b97eb08e3e0d120daa2d6e6b165cb8523a00e0dd8c4e2f70a20f3dfff92112ccca3aa19f8aa60ee113f955cc9b1940e69d9b90340e43b960bdc186608d013d70ad9b03eb27c08365159baa3df30867d79f647a5860b3479b76f8bf9862bb79c929b05a8aec04d68d765b1ac27d8d9b4d4cebe08f79bffc79466102a6644bde94b4f6fcfeff9280213f8e15234bbcb8edbfdb0c4c7fe9c58ce4dec510bb27669517a4958fa22f91830fbb4502ee1557d85597ce1a051c81aef95fd69386be7e02f420091de5875c44bd152f7d08d96da5f138f4bc9b9272ae4131952da82ee917886d8de6a1ce6dc05630d959d8e71763be5421f4685c2b619bb452a1de13bdd4b751660932167666c7d24278d09ff1d0bdb722c2c7f1b77769b6992cb47ae0e4365e9e49a15839036778af0891032d9dfc1b448ee634be14514aea4f1cd946e1c50a66a6535daad2ecff0dedb3e348e0722b3cb160515d3af89b922564a38c3c20c40295ee5cff81fdb6386f93b83bfb69747135f0759a236bcf66316e3ba01240124c913d2e5aaca45050c0762f9975c65473e164b26672199959dfd39d1259e6f88204c0250cb827fd8841e40b55bfd3e4e64d9a2077e2e92aa8e74ae0cb20ff585ef6157bfe787ea614fd11f121bc61dee1584cc6fc131ac0a92d4b2b53c760e8b98784f42fbd8563db5e793fe1c4c69fc972b15753da276c592576c9b0d2e379acb76e5a41a7be92e319ec2a620901ebf73afa81c90d3d053246f93eeb7dc347fb072f70b473bff38ca25ec3f50bde2a218ee28d28c86c4b89faa7a43d2486a10d74b6b5fe36d0836f06b59196fdbae4ee54b9540f9ab00f92a0930884fc41410860bb4cecf839ff686d1346ad5904f271d97cba1e74d5193e1fd74a66979cedd0ff075911c7a69f3f7655356e99d721703bec74a6bfe1cf489c0cfc00cc519a3379550b058c222399bb264f42afaee5d0740c419c3959d9f409e0022af112cd11dfac0b1c0e1a7802eef52af3161cdc0cbb8a488aaf25f08d8381e0ca4770d07f156c0f566375888b26c24bf012aed940f6fe3c97b68a2b5b284323614266c84d0e285feab548403957cb22ee29b5ba0fd9ccabd3124cded820bb174609a9acdf2113fc0c020e970a01efc7a536e72da0ee8082e76f552513add9898bbb3c481a880cea0898b5a325e4369eca03b7e920ff1f854f79f16210d86c82c339d2f1ab7ef05d2f848d13ab0a6a1f477e17f06269462e186358f57b4f6defced354bd2814ce46b95e5ff6542b05816c5a95ae5fd5e3ede3a5a1da6c64ae7fd04ca4af066b575290e1c6ef607ffc82bd14ce20d3d5d28b92731f1860fe29c32fb35a624f273097150493de900417ce3e33dc7e5c7f8450320f42034aa94c8d6720b1f73699629189dbedeab5604ff7e587b2cbd449cb982db67d3488cf88ac14af2d0e7644036f9268a9ccd850c1a245d14082d0eb5a37e6346288e78ac627adcf82425b8270e86e32937cc9918a8300cc87e1e1d39518e7d57e176eb9cc2745ff33373f4519372eb1a7000f4cc45519d6940805f40d86440d87b34b9547e4ad9055a32ea6b53e938e85c373cc7d4d073551a3cf1c70fde86ed7b6f7575016f689dfdb1385f70c088fd764e62919fb0c7dec6ced8b1c24a678686495567b37b059d6eba5d74ea3fbd9835b831086c5b88b891a36b32dbbe05f2a16b0a0f1ef6498420cc4a032441336ad95b65fb5907bbda6886eece5c127a1fc80147592cd26441f4395d575587bc577bcf31b8c26417388168bd3127635575656ed4dbb824c9fef8d0389cc1f5d9ca4cef01db6e169e4b612cc14438d9935cd80a5307e08acd105d3f28c672647dace5b85308466414e7f3faba00c027a51e2a6fd7d1d7bba0fb3c7c603cd76133f88ac9849ca71e6adbe44685cd75e25b106d181a98c1fea387720958887fbc2d9998aa207ad44cc8716517996e08279e7f576a34a12366153e5a5871e4d984356e43ffad5c4fc403070ee8fbcf8206c4521ddc0a9b229cdb927e5cba9cef03ce6bd755500b5bf7b53166db459139d94ae6a42df9f2d98a045ff0476f503890a2e6788e67dd79b7a7391626e1ee9e232d3030948b69f518b9a94c8a68fa765f48dc117a901310e44d4213c817a4598807c0e26da9f12792ea9cc23d3baedff2ee94bb05a4e98dc4e7f1e6abe6b44246aacb766e5c4cc73765f922f8b9abe2460e2ed2049297a7970f5f0d0f3f2cb1856a66ec1ab87ab3b6af27a3aeb1ef3b64388e5ba0cd7c75c50ac1ac5d42df1909de224baf21d9ef0f5860355282c9d8018bb7738abc5c7bdca7a0740baa56c8db7051a2c2b6ed29ad0d54ca866bbf08ab8e2fe6969f6bfd530d505ee7ffb4599f66616b0e408689f7296def25b94823a3e25170dbe6e432337c2d3ea304d6bc203a0d7f78a73d918c220ab805a7d224a6dce0b6ec71d989d36d9c1619d500fa66b9c25fc56bcf677f512f78993a9a9d481f19e290e3d7e7b4b5a681b9a44332b1a5e7703df628dafb061cd749c350581a06bfc950f2f399d6a9ac7bb7c007a91632b8653fa54c7fbdc8ab6e35470e238371d20740e70da03afce9a20c5b8d1127567fa2799642250bf612ccdc2f27cbcd3ea7c70dc4c7c2e6fac359a11cd383c737b94995777fcf63e78fed84ff67638dd149cc09039fc76d810864200bd30e89bde9205acdaca296af5914e2bae8f6e1da92a42937b0df9b8e9d88dbb78d4860ffbf897477f3a6e870cce139e893e05d61761ec0ecf36a78d4b36a52a92d8fd8b5c89a27b00d1f978dd98c2ae8e6c3ac6590e9346c059857f2e5fe86d8266b13b5a3ad787bef359ed64ffe7316f9584720a2e9f975a8324785df26d4940baae6b0cf0d42e91738faee702254aa1d30adc63591c3dfd2d3c0e716f4e4410542c95cfbc3dee5acb367ef3f39e23a8b2b2062917e1f67682966c993f2da3aa89d55e041111e8e07eb5d1b639658beb202776b350c8c1bb4c6b7e5b39b020fd07018047b5ebeae0fa35ae6f9e51813f447a4e270455ac42c13da208c0dfd836465a059b257c8dbb486f89504e10993ff8d2c34760f42a0c508f765c472f1c4a423d187eb6f87400bcc7e2138d9e0b87957f46ea5510cb8e18ae5a58a11517e76e2640910aa7a625fe3e5e01b12b3d427a5ff8c6d534536daad8ee39c37c4a3b20b1576bf912c7cc507d0abade60cf0805a250d98051b0104c1d7b056749b2537acfc0771de74ec29400812179449d3576d7259d452a09990df307dbfa4b57932f84e232c15451754ae921a60824d43262fe2345f0aa8603c8fe3360ff49d70a5cf19870c74cbe43ec96a305014a0ed6e46fced4cd0543cd3d43d177e5f8872d3e4f12988a579944ee7503202e2478bc7cbcb71141c185fcb04ee5006cb31ecb9223b66c441cff38baf3178bb725719c75c4bf53e6bf8e50184ea14bd08736dccf19794ceef10db7fbd1b7c02736136476f6dd5b359ff298c83f749da67c39a7ba8236a35a0f3756a6f6cdee2afeb30fa942be2a241a516acf6a7181f425dc14bf2402080b08a4cf769c73bc0c45d62ec43486c53545fbb8dda614fdfbc99e73bb66cdc150f540eb0df21447127c15b554bada5f0995ffcb7331d3cbfbf5b976e940f1e9e5469d37961b35c3d1b3e766bb9984ea9a2414df62fc6b72704b4b571e46d1ca3eb5e0b8140a2201c55ccfbb0614faeddd56ede79c40eb7565ddc28638512dfec3e5d66dc08f220333743208017df511d284538b3841337d37e23dd59de1f7dac944dda0d112bfe7279693ead3d139ac2e5bc75ebe498d314f2286fd59571ce1b602d65e50c0d45ff15c7eb740d56978330a0191934ff614200cae1e570dec82386f25d6af985cb9ad7a3a494168400c7c63a58683758b6b07d2683907dee61d56dd57bd17ab3324580026cef0016b0f41c5ed900a76b818c38c278031d3c442714419e13f5203fc3a61b45c991c5dca00b8e0c8947189861e42ec32516d5234b4e8c0505d8758ea365467ba63ea508624517e4b0f8330b5bf65c7c94fbe93f287009a6144ac367b4084cfad17a71c60efd5d5fbbcd80ee082ea877df33db87cfa98760bd2f6c57f7d405c27e3f638cd9503f5983c151d21acd5270141c65273d73a9a94531e5d9ef55f23fcfc8043075c25094b1af5c6934f6f6f88cfd601c3a9b808a175c46ff0c4ec4e12f3e62228262bb1cb6b18ef4b8896635f1ec2d157727e508d97c6940223079305627df49babd58c9f69c70ad7faf56f4708d0819f7b19ab3673c9e2a7d34ec4bed4de15cfc385003b42a5c52bd4e60228bcc96ff0e0cd1f09f58f31bb17cff873796ebe7e6e499206c5e6fc0bfc8ccea3f336b90bde297db748b624b741a6c2f51370063c261db22083988a4d977a7e6830faa168869c6c9da5b8f82842626c9395183b734c6bc16b001089abb6e8aa18cc00e817fc1ebb7e6eed6a388cf28a325df38d6b04522600796b92a3bcac17f5b3c7567b47860e1340d2f1f7507b0719a2a8e7d8619ca48f17829ad5fe23c0e63b44b9f27943ca01c9f328b1e1920c0cbf9d783c84b6dc2da1232097c98726c24a00f413abf067e9643f16dd8d068075c150f6ee1e860def248d64882d1250dc1a0fff4225b8784db950db08e920b31d7dad71624d01f5e767915e77b67313ca1dfb36e612852f2d0c09cffb068111f8e212a38ec5cc592971c61fdf12f054bb6f2f30db7dcab6138f68154645b41520574ff2056413b0d343a9a96e09c063c2dd0876d754404799b2e86efa72ba174b184be72c641ccaa9311d07713f8c3a484438857f5961dff380d732b551aa7af52fde1d1357bcee45d7e91678a60bf6f5eb10c764bd2fa5c2fa90afc2edcf6394c016fc12ed71daf999d5ed9bd5a47d44d55b77d0c035a38e541dece9cc5f0794dc6bd08bf39ef97a32cf0adaa7334c34add495a2d98e27f59cfdcd80dcc330536856ff0375500c8b7818aa855ec3efe9f6b7408903d8220835b03f4ff4c00a47c508883e746eb4bc018d279ae693d891252c6fb95a2a7f08a049b52c30edd61368e4e2c2ffcfaa956b923168d495386669db80bf9f2c4317e0354a2db84c442294afc2b2ddbc4d4bcba9e7579fb173699e62d7440fc8dbc3d434bcd0f0a1c305ab781e850ed24785d22f8de3c61278e3042cff88d5e15b9000777863a5e3dbeef19c5673d8402ddb40ee2ecb3c1c451'

function getKey(token) {
  let str = token.substr(-16, 16)
  return new Uint8Array(Buffer.from(str, 'utf8'))
}

function deCrypted(token, encrypted) {
  const key = getKey(token)
  const helper = crypto.createDecipheriv("aes128", key, key)
  let buffer = helper.update(encrypted, "hex", "utf8")
  buffer += helper.final('utf8')
  return pako.inflate(buffer, {to: 'string'})
}

const res = deCrypted(token, encrypted)
console.log(res)
