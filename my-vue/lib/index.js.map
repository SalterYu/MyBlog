{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/core/compile/index.js","webpack:///./src/core/index.js","webpack:///./src/core/instance/init.js","webpack:///./src/core/instance/lifecycle.js","webpack:///./src/core/instance/proxy.js","webpack:///./src/core/observer/dep.js","webpack:///./src/core/observer/index.js","webpack:///./src/core/observer/watcher.js","webpack:///./src/index.js"],"names":["Compiler","el","vm","$el","document","querySelector","console","log","replace","frag","childNodesList","Array","from","childNodes","baseReg","keyReg","key","RegExp","getVal","keys","val","forEach","node","resultTxt","textContent","nodeType","exec","matchVal","$1","split","trim","$watch","newValue","oldValue","attributes","attr","name","exp","value","includes","addEventListener","e","target","length","Wue","options","$options","expOrFn","cb","Watcher","initOptions","callHook","Object","_data","proxy","LIFECYCLE_HOOKS","noop","data","observer","hook","handler","call","sourceKey","defineProperty","configurable","get","proxyGetter","set","proxySetter","newVal","Dep","subs","addSub","sub","push","notify","update","depend","subscribe","targetStack","pushTarget","_target","popTarget","pop","def","obj","enumerable","writable","Observer","walk","defineReactive","dep","originValue","_changeValue","window"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","class Compiler {\n  constructor(el, vm) {\n    this.vm = vm\n    vm.$el = document.querySelector(el)\n    console.log(vm.$el)\n    this.replace(vm.$el, vm)\n  }\n\n  replace(frag, vm) {\n    const childNodesList = Array.from(frag.childNodes)\n    const baseReg = /[{][{]((?:.|\\n)+?)[}][}]/g\n    const keyReg = (key) => {\n      return new RegExp(`[{][{](?:(${key})+?)[}][}]`, 'g')\n    }\n    const getVal = (keys, vm) => {\n      let val = vm\n      keys.forEach(key => {\n        val = val[key]\n      })\n      return val\n    }\n    childNodesList.forEach(node => {\n      let resultTxt = node.textContent\n      // 如果是文本节点\n      if (node.nodeType === 3) {\n        while (baseReg.exec(node.textContent)) {\n          let matchVal = RegExp.$1\n          let keys = RegExp.$1.split('.')\n          let val = getVal(keys, vm)\n          resultTxt = resultTxt.replace(keyReg(matchVal), val).trim()\n          vm.$watch(RegExp.$1, (newValue, oldValue) => {\n            resultTxt = resultTxt.replace(oldValue, newValue).trim()\n            node.textContent = resultTxt\n          })\n        }\n        node.textContent = resultTxt\n      }\n      // 如果是元素节点\n      if (node.nodeType === 1) {\n        Array.from(node.attributes).forEach(attr => {\n          const { name, value: exp } = attr\n          if (name.includes('w-')) {\n            if (name.includes('w-model')) {\n              node.value = vm[exp]\n              vm.$watch(exp, (newValue, oldValue) => {\n                node.value = newValue\n              })\n              node.addEventListener('input', (e) => {\n                vm[exp] = e.target.value\n              })\n            }\n          }\n        })\n      }\n\n      // 若还有子节点则递归\n      if (node.childNodes && node.childNodes.length > 0) {\n        this.replace(node, vm)\n      }\n    })\n  }\n}\n\nexport default Compiler","import initOptions from './instance/init'\nimport proxy from \"./instance/proxy\";\nimport Compiler from \"./compile\";\nimport Watcher from \"./observer/watcher\";\nimport callHook from './instance/lifecycle'\n\nexport default class Wue {\n  constructor(options) {\n    const vm = this\n    vm.$options = options\n    vm.$watch = (expOrFn, cb) => {\n      return new Watcher(vm, expOrFn, cb)\n    }\n    initOptions(vm)\n    callHook(vm, 'mounted')\n    Object.keys(vm._data).forEach(key => {\n      proxy(vm, '_data', key)\n    })\n    new Compiler(this.$options.el, vm)\n  }\n}","import observer from \"../observer\";\nconst LIFECYCLE_HOOKS = [\n  'created',\n  'mounted'\n]\nconst noop = function () {}\nexport default function initOptions (vm) {\n  let data = vm._data = vm.$options.data\n  observer(vm._data )\n  LIFECYCLE_HOOKS.forEach(hook => {\n    vm.$options[hook] = vm.$options[hook] || noop\n  })\n}","export default function callHook(vm, hook) {\n  const handler = vm.$options[hook]\n  if (handler) handler.call(vm)\n}","export default function proxy(target, sourceKey, key) {\n  Object.defineProperty(target, key, {\n    configurable: true,\n    get: function proxyGetter() {\n      return target[sourceKey][key]\n    },\n    set: function proxySetter(newVal) {\n      target[sourceKey][key] = newVal\n    }\n  })\n}","// @flow\n\nimport type Watcher from './watcher'\n\nclass Dep {\n  static target: ?Watcher\n  subs: Array<Watcher>\n\n  constructor() {\n    this.subs = []\n  }\n\n  addSub(sub: Watcher) {\n    this.subs.push(sub)\n  }\n\n  notify() {\n    this.subs.forEach(sub => sub.update())\n  }\n\n  depend() {\n    if (Dep.target) {\n      Dep.target.subscribe(this)\n    }\n  }\n}\n\nDep.target = null\nconst targetStack = []\n\nexport function pushTarget(_target: ?Watcher) {\n  if (Dep.target) targetStack.push(_target)\n  Dep.target = _target\n}\n\nexport function popTarget() {\n  Dep.target = targetStack.pop()\n}\n\nexport default Dep\n","import Dep from './dep'\nexport function def (obj: Object, key: string, val: any, enumerable?: boolean) {\n  Object.defineProperty(obj, key, {\n    value: val,\n    enumerable: !!enumerable,\n    writable: true,\n    configurable: true\n  })\n}\nclass Observer {\n  constructor(value) {\n    this.value = value\n    def(value, '__ob__', this)\n    this.walk(value)\n  }\n\n  walk(obj) {\n    Object.keys(obj).forEach(key => {\n      if (typeof obj[key] === 'object') observer(obj[key])\n      defineReactive(obj, key, obj[key])\n    })\n  }\n}\n\nexport const defineReactive = (obj, key, value) => {\n  let dep = new Dep()\n  // 如果value值是object则继续observer\n\n  Object.defineProperty(obj, key, {\n    get() {\n      if (Dep.target) {\n        dep.depend()\n      }\n      return value\n    },\n    set(newVal) {\n      if (newVal === value) return\n      // console.log(`setter: ${newVal}`)\n      value = newVal\n      console.log(dep)\n      dep.notify()\n    }\n  })\n\n}\nexport default function observer(value) {\n  return new Observer(value)\n}\n\n","// @flow\n\nimport type Dep from './dep'\nimport {pushTarget, popTarget} from \"./dep\";\n\nclass Watcher {\n  cb: Function\n  expOrFn: string // dom里面的花括号表达式{{}}, 当前当作非方法来使用\n  vm: any // Vue的组件\n  originValue: any // 初始值\n  _changeValue: any // 被改变的值\n  constructor(vm: any, expOrFn: string, cb: Function) {\n    debugger\n    this.cb = cb;\n    this.vm = vm;\n    this.expOrFn = expOrFn\n    this.originValue = this.get()\n    this._changeValue = this.originValue\n  }\n\n  update() {\n    let newValue = this.vm\n    let oldValue = this._changeValue\n    this.expOrFn.split('.').forEach((key) => {\n      newValue = newValue[key]\n    })\n    this._changeValue = newValue\n    this.cb.call(this.vm, newValue, oldValue)\n  }\n\n  subscribe(dep: Dep) {\n    dep.addSub(this)\n  }\n\n  get() {\n    pushTarget(this)\n    let val = this.vm\n    this.expOrFn.split('.').forEach(key => {\n      val = val[key]\n    })\n    popTarget()\n    return val\n  }\n}\n\nexport default Watcher","import Wue from './core'\nwindow.Wue = Wue\n"],"sourceRoot":""}